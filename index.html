<!DOCTYPE html><html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø¥ØªÙ‚Ø§Ù†</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script type="module">
        // ====================
        // Firebase Initialization
        // ====================
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";const firebaseConfig = {
        apiKey: "AIzaSyAyTfVJ2sx-OGUx_ny1_W1QRvzkjA7_aAQ",
        authDomain: "itqan-platform-4b7cc.firebaseapp.com",
        databaseURL: "https://itqan-platform-4b7cc-default-rtdb.firebaseio.com",
        projectId: "itqan-platform-4b7cc",
        storageBucket: "itqan-platform-4b7cc.appspot.com",
        messagingSenderId: "59657931493",
        appId: "1:59657931493:web:695e8fb4053156aad1220c",
        measurementId: "G-81TN8CX9ZH"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
</script>

</head>
<body>
    <!-- Auth Screen -->
    <div id="auth-screen">
        <h2>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ù†ØµØ© Ø¥ØªÙ‚Ø§Ù†</h2>
        <button onclick="handleLogin('student')">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø·Ø§Ù„Ø¨</button>
        <button onclick="handleAdminLogin()">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±</button>
    </div><!-- Main App -->
<div id="app" style="display:none;">
    <!-- Sidebar -->
    <aside id="sidebar">
        <ul>
            <li class="nav-item active" onclick="showSection('dashboard')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</li>
            <li class="nav-item" onclick="showSection('subjects')">Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</li>
            <li class="nav-item" onclick="showSection('videos')">Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</li>
            <li class="nav-item" onclick="showSection('files')">Ø£ÙˆØ±Ø§Ù‚ÙŠ ÙˆØ³Ù†ÙˆØ§ØªÙŠ</li>
            <li class="nav-item" onclick="showSection('teachers')">Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†</li>
            <li id="admin-nav-item" class="nav-item d-none" onclick="showSection('admin')">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</li>
            <li class="nav-item" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</li>
        </ul>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Sections will be dynamically loaded -->
    </main>
</div>

<!-- JavaScript -->
<script>
    // ====================
    // Data Management
    // ====================
    let platformData = {
        subjects: [], teachers: [], videos: [], files: [], nextId: { subjects:1, teachers:1, videos:1, files:1 }
    };
    let currentUser = null;
    let isAdmin = false;

    function saveData() {
        localStorage.setItem('itqan_platform_data', JSON.stringify(platformData));
        updateStats();
    }

    function loadData() {
        const saved = localStorage.getItem('itqan_platform_data');
        if (saved) platformData = JSON.parse(saved);
    }

    // ====================
    // Authentication
    // ====================
    function handleLogin(role){
        if(role==='student'){ currentUser={name:'Ø·Ø§Ù„Ø¨ Ø¥ØªÙ‚Ø§Ù†',role:'student',avatar:'Ø·'}; isAdmin=false; }
        else if(role==='admin'){ currentUser={name:'Ø§Ù„Ù…Ø¯ÙŠØ± Ø¹Ù…Ø±Ø§Ù†',role:'admin',avatar:'Ù…'}; isAdmin=true; document.getElementById('admin-nav-item').classList.remove('d-none'); }
        document.getElementById('auth-screen').style.display='none';
        document.getElementById('app').style.display='block';
        document.getElementById('user-avatar').textContent=currentUser.avatar;
        localStorage.setItem('currentUser',JSON.stringify(currentUser));
        updateStats();
        loadDashboardContent();
        showAlert(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${currentUser.name}!`,'success');
    }

    function handleAdminLogin(){
        const password=prompt('ğŸ” Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø¯ÙŠØ±:');
        if(password==='Omran#05') handleLogin('admin');
        else if(password!==null) showAlert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©!','danger');
    }

    function logout(){
        if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')){
            localStorage.removeItem('currentUser'); location.reload();
        }
    }

    window.onload=function(){
        loadData();
        const saved=localStorage.getItem('currentUser');
        if(saved){
            currentUser=JSON.parse(saved);
            isAdmin=currentUser.role==='admin';
            document.getElementById('auth-screen').style.display='none';
            document.getElementById('app').style.display='block';
            if(isAdmin) document.getElementById('admin-nav-item').classList.remove('d-none');
            updateStats();
            loadDashboardContent();
        }
    };

    // ====================
    // Alerts & UI
    // ====================
    function showAlert(msg,type='info'){
        const alertDiv=document.createElement('div');
        alertDiv.className=`alert alert-${type} alert-toast`;
        alertDiv.style.position='fixed'; alertDiv.style.top='80px'; alertDiv.style.right='20px'; alertDiv.style.zIndex='9999';
        alertDiv.innerHTML=`<i class='fas fa-${type==='success'?'check-circle':type==='danger'?'exclamation-circle':'info-circle'}'></i><div>${msg}</div>`;
        document.body.appendChild(alertDiv);
        setTimeout(()=>{ alertDiv.remove(); },5000);
    }

    // ====================
    // Stats
    // ====================
    function updateStats(){
        // Example: update dashboard stats dynamically if HTML elements exist
    }

    function loadDashboardContent(){
        // Example dashboard loader
    }

    // ====================
    // Admin & CRUD functions (Subjects, Teachers, Videos, Files)
    // Implement all functions like adminAddSubject, adminDeleteSubject, adminAddVideo etc.
    // All functions save to localStorage using saveData() and update UI
    // ====================

    // ====================
    // Backup / Import & Export
    // ====================
    function exportData(){
        const dataStr=JSON.stringify(platformData,null,2);
        const dataUri='data:application/json;charset=utf-8,'+encodeURIComponent(dataStr);
        const link=document.createElement('a');
        link.setAttribute('href',dataUri);
        link.setAttribute('download',`itqan_backup_${new Date().toISOString().slice(0,10)}.json`);
        link.click(); showAlert('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­','success');
    }

    function importData(event){
        const file=event.target.files[0]; if(!file) return;
        const reader=new FileReader();
        reader.onload=function(e){
            try{
                const importedData=JSON.parse(e.target.result);
                if(!importedData.subjects||!importedData.teachers||!importedData.videos||!importedData.files) throw new Error('Ù…Ù„Ù Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ§Ù„Ø­');
                if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŸ')){
                    platformData=importedData; saveData(); showAlert('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­','success');
                }
            }catch(err){ showAlert('Ø®Ø·Ø£ ÙÙŠ Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: '+err.message,'danger'); }
        };
        reader.readAsText(file);
        event.target.value='';
    }

    // ====================
    // Sidebar toggle & section show
    // ====================
    function toggleSidebar(){ document.getElementById('sidebar').classList.toggle('active'); }
    function showSection(id){
        // Logic to hide all sections, show selected, update nav active
    }

</script>

</body>
</html>
